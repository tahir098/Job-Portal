!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(d){var c=d.summernote.ui,l=d.summernote.dom;d.extend(!0,d.summernote,{plugins:{databasic:function(i){var r=this,n=i.options,s=n.langInfo;r.icon='<i class="fa fa-object-group"/>',i.memo("button.databasic",function(){return c.button({contents:r.icon,tooltip:s.databasic.insert,click:i.createInvokeHandler("databasic.showDialog")}).render()}),i.memo("button.databasicDialog",function(){return c.button({contents:r.icon,tooltip:s.databasic.edit,click:i.createInvokeHandler("databasic.showDialog")}).render()}),i.memo("button.databasicSize100",function(){return c.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:s.image.resizeFull,click:i.createInvokeHandler("editor.resize","1")}).render()}),i.memo("button.databasicSize50",function(){return c.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:s.image.resizeHalf,click:i.createInvokeHandler("editor.resize","0.5")}).render()}),i.memo("button.databasicSize25",function(){return c.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:s.image.resizeQuarter,click:i.createInvokeHandler("editor.resize","0.25")}).render()}),r.events={"summernote.init":function(e,t){d("data.ext-databasic",t.editable).each(function(){r.setContent(d(this))})},"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){r.update()},"summernote.dialog.shown":function(){r.hidePopover()}},r.initialize=function(){var e=n.dialogsInBody?d(document.body):i.layoutInfo.editor,t='<div class="form-group row-fluid"><label>'+s.databasic.testLabel+'</label><input class="ext-databasic-test form-control" type="text" /></div>',a='<button href="#" class="btn btn-primary ext-databasic-save">'+s.databasic.insert+"</button>";r.$dialog=c.dialog({title:s.databasic.name,fade:n.dialogsFade,body:t,footer:a}).render().appendTo(e),r.$popover=c.popover({className:"ext-databasic-popover"}).render().appendTo("body");var o=r.$popover.find(".popover-content");i.invoke("buttons.build",o,n.popover.databasic)},r.destroy=function(){r.$popover.remove(),r.$popover=null,r.$dialog.remove(),r.$dialog=null},r.update=function(){if(i.invoke("editor.hasFocus")){var e=i.invoke("editor.createRange"),t=!1;if(e.isOnData()){var a=d(e.sc).closest("data.ext-databasic");if(a.length){var o=l.posFromPlaceholder(a[0]);r.$popover.css({display:"block",left:o.left,top:o.top}),i.invoke("editor.saveTarget",a[0]),t=!0}}t||r.hidePopover()}else r.hidePopover()},r.hidePopover=function(){r.$popover.hide()},r.getInfo=function(){var e=i.invoke("editor.createRange");if(e.isOnData()){var t=d(e.sc).closest("data.ext-databasic");if(t.length)return{node:t,test:t.attr("data-test")}}return{}},r.setContent=function(e){e.html('<p contenteditable="false">'+r.icon+" "+s.databasic.name+": "+e.attr("data-test")+"</p>")},r.updateNode=function(e){r.setContent(e.node.attr("data-test",e.test))},r.createNode=function(e){var t=d('<data class="ext-databasic"></data>');return t&&(e.node=t,i.invoke("editor.insertNode",t[0])),t},r.showDialog=function(){var t=r.getInfo(),a=!t.node;i.invoke("editor.saveRange"),r.openDialog(t).then(function(e){c.hideDialog(r.$dialog),i.invoke("editor.restoreRange"),a&&r.createNode(t),d.extend(t,e),r.updateNode(t)}).fail(function(){i.invoke("editor.restoreRange")})},r.openDialog=function(n){return d.Deferred(function(t){var a=r.$dialog.find(".ext-databasic-test"),o=r.$dialog.find(".ext-databasic-save"),e=function(e){13===e.keyCode&&o.trigger("click")};c.onDialogShown(r.$dialog,function(){i.triggerEvent("dialog.shown"),a.val(n.test).on("input",function(){c.toggleBtn(o,a.val())}).trigger("focus").on("keyup",e),o.text(n.node?s.databasic.edit:s.databasic.insert).click(function(e){e.preventDefault(),t.resolve({test:a.val()})}),c.toggleBtn(o,a.val())}),c.onDialogHidden(r.$dialog,function(){a.off("input keyup"),o.off("click"),"pending"===t.state()&&t.reject()}),c.showDialog(r.$dialog)})}}},options:{popover:{databasic:[["databasic",["databasicDialog","databasicSize100","databasicSize50","databasicSize25"]]]}},lang:{"en-US":{databasic:{name:"Basic Data Container",insert:"insert basic data container",edit:"edit basic data container",testLabel:"test input"}}}})});